{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Jacana\\\\Documents\\\\IPL\\\\PFE\\\\TestReact\\\\src\\\\components\\\\Search.js\";\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport FilmItem from \"./FilmItem\";\nimport load from \"../../API/TMDBApi\";\n\nvar Search = function Search() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      films = _useState2[0],\n      setFilms = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var searchedFilm = useRef(\"\");\n  var c_page = useRef(0);\n  var total_page = useRef(0);\n  var shouldReset = false;\n\n  var load_film = function load_film() {\n    console.log(searchedFilm.current.length);\n\n    if (searchedFilm.length > 0) {\n      console.log(\"Loading films\");\n      setLoading(true);\n      load(searchedFilm, c_page.current).then(function (res) {\n        setFilms(films.concat(res.data.results));\n        setLoading(false);\n        c_page.current = res.data.page;\n        total_page.current = res.data.total_pages;\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    }\n  };\n\n  var pressed = function pressed() {\n    searchFilm();\n  };\n\n  useEffect(function () {\n    console.log(\"Resetting pages\");\n\n    if (shouldReset) {\n      c_page.current = 0;\n      total_page.current = 0;\n    }\n\n    shouldReset = false;\n    load_film();\n  }, [films]);\n\n  var searchFilm = function searchFilm() {\n    shouldReset = true;\n    setFilms([]);\n  };\n\n  var displayLoad = function displayLoad() {\n    if (loading) {\n      return React.createElement(View, {\n        style: styles.loading,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }\n      }, React.createElement(ActivityIndicator, {\n        size: \"large\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 13\n        }\n      }));\n    }\n  };\n\n  return React.createElement(View, {\n    style: styles.main_container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  }, React.createElement(TextInput, {\n    placeholder: \"Titre du film\",\n    style: styles.textinput,\n    onChangeText: function onChangeText(text) {\n      return searchedFilm = text;\n    },\n    onSubmitEditing: function onSubmitEditing() {\n      searchFilm();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }\n  }), React.createElement(Button, {\n    title: \"Rechercher\",\n    onPress: pressed,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }\n  }), React.createElement(FlatList, {\n    data: films,\n    keyExtractor: function keyExtractor(item) {\n      return item.id.toString();\n    },\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(FilmItem, {\n        props: item,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 37\n        }\n      });\n    },\n    onEndReachedThreshold: 0.1,\n    onEndReached: function onEndReached() {\n      console.log(\"End Reached\");\n\n      if (c_page.current < total_page.current) {\n        console.log(\"Loading more movies\");\n        load_film();\n      }\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }\n  }), displayLoad());\n};\n\nvar styles = StyleSheet.create({\n  textinput: {\n    marginLeft: 5,\n    marginRight: 5,\n    height: 50,\n    borderColor: '#000000',\n    borderWidth: 1,\n    paddingLeft: 5\n  },\n  main_container: {\n    flex: 1,\n    marginTop: 20\n  },\n  loading: {\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    top: 100,\n    bottom: 0,\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});\nexport default Search;","map":{"version":3,"sources":["C:/Users/Jacana/Documents/IPL/PFE/TestReact/src/components/Search.js"],"names":["React","useEffect","useRef","useState","FilmItem","load","Search","films","setFilms","loading","setLoading","searchedFilm","c_page","total_page","shouldReset","load_film","console","log","current","length","then","res","concat","data","results","page","total_pages","catch","err","error","pressed","searchFilm","displayLoad","styles","main_container","textinput","text","item","id","toString","StyleSheet","create","marginLeft","marginRight","height","borderColor","borderWidth","paddingLeft","flex","marginTop","position","left","right","top","bottom","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from 'react'\r\nimport {StyleSheet,View,TextInput,FlatList,Button, ActivityIndicator} from 'react-native'\r\nimport FilmItem from './FilmItem'\r\nimport load from '../../API/TMDBApi'\r\n\r\nconst Search = () => {\r\n\r\n    const [films,setFilms] = useState([])\r\n    const [loading,setLoading] = useState(false)\r\n    var searchedFilm = useRef(\"\")\r\n    const c_page = useRef(0)\r\n    const total_page= useRef(0)\r\n    var shouldReset = false\r\n\r\n    var load_film = () => {\r\n      console.log(searchedFilm.current.length)\r\n      if(searchedFilm.length > 0){\r\n        console.log(\"Loading films\")\r\n        setLoading(true)\r\n        load(searchedFilm,c_page.current).then(res => {\r\n          setFilms(films.concat(res.data.results))\r\n          setLoading(false)\r\n          c_page.current = res.data.page\r\n          total_page.current = res.data.total_pages\r\n      })\r\n      .catch((err) => console.error(err))\r\n    }\r\n    }\r\n\r\n    const pressed = () => {\r\n        searchFilm()\r\n    }\r\n\r\n    useEffect( () => {\r\n      console.log(\"Resetting pages\")\r\n      if(shouldReset){\r\n        c_page.current = 0\r\n        total_page.current = 0\r\n      }\r\n      shouldReset = false\r\n      load_film()\r\n    },[films]\r\n    )\r\n\r\n    const searchFilm = () => {\r\n      shouldReset = true\r\n      setFilms([])\r\n    }\r\n\r\n    const displayLoad = () => {\r\n      if(loading){\r\n        return(\r\n          <View style={styles.loading}>\r\n            <ActivityIndicator size=\"large\"/>\r\n          </View>\r\n        )\r\n      }\r\n    }\r\n    return(\r\n        <View style={styles.main_container}>\r\n            <TextInput \r\n              placeholder='Titre du film'\r\n              style={styles.textinput}\r\n              onChangeText= {(text) =>searchedFilm = text} \r\n              onSubmitEditing = {() =>{\r\n                searchFilm()\r\n              } } />\r\n            <Button title='Rechercher' onPress={pressed}/>\r\n            <FlatList\r\n            data={films}\r\n            keyExtractor={(item) => item.id.toString()}\r\n            renderItem={({item}) => <FilmItem props={item}/>}\r\n            onEndReachedThreshold={0.1}\r\n            onEndReached={ () => {\r\n              console.log(\"End Reached\")\r\n              if(c_page.current < total_page.current){\r\n                console.log(\"Loading more movies\")\r\n                load_film()\r\n              }\r\n              }\r\n            }/>\r\n            {displayLoad()}\r\n        </View>\r\n    )\r\n}\r\n\r\n// Components/Search.js\r\n\r\nconst styles = StyleSheet.create({\r\n    textinput: {\r\n      marginLeft: 5,\r\n      marginRight: 5,\r\n      height: 50,\r\n      borderColor: '#000000',\r\n      borderWidth: 1,\r\n      paddingLeft: 5\r\n    },\r\n    main_container :{\r\n        flex:1,\r\n        marginTop:20\r\n    },\r\n    loading :{\r\n      position: 'absolute',\r\n      left: 0,\r\n      right: 0,\r\n      top: 100,\r\n      bottom: 0,\r\n      alignItems: 'center',\r\n      justifyContent: 'center'\r\n    }\r\n  })\r\n\r\nexport default Search"]},"metadata":{},"sourceType":"module"}